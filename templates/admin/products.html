{% extends "base.html" %}
{% block title %}ðŸ“¦ Produktverwaltung{% endblock %}

{% block content %}
<div class="dashboard-container" style="max-width:1100px;margin:0 auto;">

  <h1 style="font-size:1.6rem;font-weight:700;margin-bottom:1rem;">ðŸ“¦ Produktverwaltung</h1>
  <p style="margin-bottom:1.5rem;">Hier kannst du Produkte hinzufÃ¼gen, bearbeiten und verwalten.</p>

  <!-- âœ… Formular: Neues Produkt -->
  <section style="background:white;padding:1rem;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.05);margin-bottom:2rem;">
    <h2 style="margin-top:0;font-size:1.2rem;margin-bottom:1rem;">âž• Neues Produkt hinzufÃ¼gen</h2>

    <form method="post" action="/dashboard/products/create" 
          style="display:flex;flex-wrap:wrap;gap:1rem;align-items:flex-end;">
      
      <!-- Produktname -->
      <div style="flex:1;min-width:200px;">
        <label style="font-size:0.9rem;">Produktname</label>
        <input type="text" name="name" placeholder="Produktname" required 
               style="width:100%;padding:8px;border:1px solid #ddd;border-radius:6px;">
      </div>

      <!-- Beschreibung -->
      <div style="flex:2;min-width:300px;">
        <label style="font-size:0.9rem;">Beschreibung</label>
        <input type="text" name="description" placeholder="Beschreibung"
               style="width:100%;padding:8px;border:1px solid #ddd;border-radius:6px;">
      </div>

      <!-- Preis + WÃ¤hrung -->
      <div style="display:flex;gap:0.5rem;align-items:flex-end;">
        <div>
          <label style="font-size:0.9rem;">Preis</label>
          <input type="number" step="0.01" name="price" placeholder="0.00" required
                 style="width:120px;padding:8px;border:1px solid #ddd;border-radius:6px;">
        </div>
        <div>
          <label style="font-size:0.9rem;">WÃ¤hrung</label>
          <select name="currency" required style="padding:8px;border:1px solid #ddd;border-radius:6px;">
            <option value="EUR">â‚¬ EUR</option>
            <option value="CHF">CHF</option>
            <option value="USD">$ USD</option>
            <option value="GBP">Â£ GBP</option>
          </select>
        </div>
      </div>

      <!-- Aktiv -->
      <div style="display:flex;align-items:center;gap:0.3rem;">
        <input type="checkbox" name="active" checked>
        <label style="font-size:0.9rem;">Aktiv</label>
      </div>

      <!-- Button -->
      <button type="submit"
              style="background:#4f46e5;color:white;border:none;padding:0.6rem 1.2rem;border-radius:6px;cursor:pointer;">
        âž• Erstellen
      </button>
    </form>
  </section>

  <!-- ðŸ“ƒ Produktliste -->
  {% if products|length == 0 %}
    <div style="background:white;padding:1rem;border-radius:8px;text-align:center;">
      ðŸ“­ Noch keine Produkte vorhanden.
    </div>
  {% else %}
    <table style="width:100%;border-collapse:collapse;background:white;border-radius:8px;overflow:hidden;box-shadow:0 2px 6px rgba(0,0,0,0.05);">
      <thead style="background:#f4f6f8;">
        <tr>
          <th style="padding:0.6rem;text-align:left;">ID</th>
          <th style="padding:0.6rem;text-align:left;">Name</th>
          <th style="padding:0.6rem;text-align:left;">Beschreibung</th>
          <th style="padding:0.6rem;text-align:left;">Preis</th>
          <th style="padding:0.6rem;text-align:left;">WÃ¤hrung</th>
          <th style="padding:0.6rem;text-align:left;">Status</th>
          <th style="padding:0.6rem;text-align:center;">Aktionen</th>
        </tr>
      </thead>
      <tbody>
        {% for p in products %}
          <tr style="border-top:1px solid #eee;">
            <td style="padding:0.6rem;">{{ p.id }}</td>
            <td style="padding:0.6rem;">{{ p.name }}</td>
            <td style="padding:0.6rem;">{{ p.description or 'â€”' }}</td>
            <td style="padding:0.6rem;">{{ "%.2f"|format(p.price) }}</td>
            <td style="padding:0.6rem;">{{ p.currency or 'EUR' }}</td>
            <td style="padding:0.6rem;">{{ "âœ… Aktiv" if p.active else "â›” Inaktiv" }}</td>
            <td style="padding:0.6rem;text-align:center;">
              <!-- Bearbeiten -->
              <form method="post" action="/dashboard/products/edit/{{ p.id }}" 
                    style="display:inline-flex;gap:0.3rem;align-items:center;">
                <input type="text" name="name" value="{{ p.name }}" required style="width:100px;padding:4px;">
                <input type="number" step="0.01" name="price" value="{{ "%.2f"|format(p.price) }}" required style="width:80px;padding:4px;">
                <select name="currency" style="padding:4px;">
                  <option value="EUR" {% if p.currency=='EUR' %}selected{% endif %}>EUR</option>
                  <option value="CHF" {% if p.currency=='CHF' %}selected{% endif %}>CHF</option>
                  <option value="USD" {% if p.currency=='USD' %}selected{% endif %}>USD</option>
                  <option value="GBP" {% if p.currency=='GBP' %}selected{% endif %}>GBP</option>
                </select>
                <input type="checkbox" name="active" {% if p.active %}checked{% endif %}>
                <button type="submit" style="background:#4f46e5;color:white;border:none;padding:0.3rem 0.6rem;border-radius:4px;">ðŸ’¾</button>
              </form>
              <!-- LÃ¶schen -->
              <a href="/dashboard/products/delete/{{ p.id }}" 
                 onclick="return confirm('Produkt wirklich lÃ¶schen?')" 
                 style="color:red;margin-left:0.5rem;">ðŸ—‘</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}

</div>
{% endblock %}