{% extends "base_dashboard.html" %} {% block title %} {% if team %}Team
bearbeiten{% else %}Neues Team{% endif %} â€“ {{ company.name }} {% endblock %} {%
block content %}

<div class="page-header">
  <h1 class="page-title">
    {% if team %}Team bearbeiten{% else %}Neues Team erstellen{% endif %}
  </h1>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <form
      method="post"
      action="{% if team %}/dashboard/teams/edit/{{ team.id }}{% else %}/dashboard/teams/create{% endif %}"
    >
      <!-- TEAM NAME + DESCRIPTION -->
      <div class="row g-4">
        <div class="col-md-6">
          <label class="form-label fw-bold">Team-Name *</label>
          <input
            type="text"
            name="name"
            class="form-control"
            value="{{ team.name if team else '' }}"
            required
          />
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">Beschreibung</label>
          <textarea name="description" class="form-control" rows="2">
{{ team.description if team else '' }}</textarea
          >
        </div>
      </div>

      <hr class="my-4" />

      <!-- MEMBERS SELECTION -->
      <div class="mb-3">
        <label class="form-label fw-bold">Team-Mitglieder</label>

        {% if all_users|length == 0 %}
        <p class="text-muted">Keine Benutzer im System vorhanden.</p>

        {% else %}
        <div class="row">
          {% for user in all_users %}
          <div class="col-md-4 col-sm-6 mb-2">
            <div class="form-check bg-light p-2 rounded border">
              <input
                class="form-check-input"
                type="checkbox"
                name="members"
                id="user_{{ user.id }}"
                value="{{ user.id }}"
                {%
                if
                team
                and
                user
                in
                team.members
                %}checked{%
                endif
                %}
              />
              <label for="user_{{ user.id }}" class="form-check-label">
                <strong>{{ user.first_name }} {{ user.last_name }}</strong
                ><br />
                <small class="text-muted">{{ user.username }}</small>
              </label>
            </div>
          </div>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      <!-- ACTION BUTTONS -->
      <div class="d-flex gap-2 mt-4">
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-save me-1"></i>
          {% if team %}Speichern{% else %}Erstellen{% endif %}
        </button>

        <a href="/dashboard/teams" class="btn btn-secondary">
          <i class="fas fa-times me-1"></i> Abbrechen
        </a>
      </div>
    </form>
  </div>
</div>

<style>
  /* Mobile style improvements */
  @media (max-width: 768px) {
    .page-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.8rem;
    }

    .form-check {
      padding: 0.6rem;
    }
  }
</style>

{% endblock %}
